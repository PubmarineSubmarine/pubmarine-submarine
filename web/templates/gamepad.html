{% extends "base.html" %}

{% block title %}Gamepad Demo - {{ super() }}{% endblock %}

{% block content %}
<div class="container">
    <div class="gamepad-section">
        <h2>üéÆ Gamepad API Demo</h2>
        <p>Connect a gamepad and press buttons to see them detected in real-time.</p>
        
        <div class="video-stream-container">
            <h3>üìπ Live Video Stream with Gamepad Overlay</h3>
            <div class="video-overlay-wrapper">
                <img src="/video_stream" alt="Live Video Stream" class="video-stream" id="video-stream">
                
                <!-- Gamepad Overlay Elements -->
                <div class="gamepad-overlay">
                    <!-- Last Button Pressed - Top Center -->
                    <div class="overlay-button-display">
                        <div class="overlay-label">Last Button</div>
                        <div class="button-display-overlay">
                            <span id="last-button" class="button-name">None</span>
                        </div>
                    </div>
                    
                    <!-- Left Analog Stick - Bottom Left -->
                    <div class="overlay-stick-left">
                        <div class="overlay-label">Left Stick</div>
                        <div class="stick-container-overlay" id="left-stick">
                            <div class="stick-indicator"></div>
                            <div class="stick-center"></div>
                        </div>
                        <div id="left-stick-values" class="stick-values-overlay">X: 0.000, Y: 0.000</div>
                    </div>
                    
                    <!-- Right Analog Stick - Bottom Right -->
                    <div class="overlay-stick-right">
                        <div class="overlay-label">Right Stick</div>
                        <div class="stick-container-overlay" id="right-stick">
                            <div class="stick-indicator"></div>
                            <div class="stick-center"></div>
                        </div>
                        <div id="right-stick-values" class="stick-values-overlay">X: 0.000, Y: 0.000</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="gamepad-error" class="error-message" style="display: none;"></div>
        
        <div class="gamepad-status">
            <div class="status-item">
                <label>Gamepad:</label>
                <span id="connection-status" class="status-disconnected">Checking...</span>
            </div>
            <div class="status-item">
                <label>WebSocket:</label>
                <span id="websocket-status" class="status-disconnected">Connecting...</span>
            </div>
            <div class="status-item">
                <label>Controller:</label>
                <span id="gamepad-info">No gamepad detected</span>
            </div>
        </div>
        

    </div>
    
    <!-- Controls are now overlayed on the video above -->
    
    <div class="history-section">
        <h3>Button Press History</h3>
        <div id="button-history" class="button-history">
            <div class="history-placeholder">Press gamepad buttons to see history...</div>
        </div>
    </div>
    
    <div class="info-section">
        <div class="navigation-links">
            <a href="/" class="nav-link">‚Üê Back to Counter Demo</a>
        </div>
    </div>
</div>

<script src="{{ url_for('static', path='/js/gamepad.js') }}"></script>
{% endblock %}